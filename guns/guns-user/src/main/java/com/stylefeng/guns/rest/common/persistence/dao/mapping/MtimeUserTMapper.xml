<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.stylefeng.guns.rest.common.persistence.dao.MtimeUserTMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.stylefeng.guns.rest.common.persistence.model.MtimeUserT">
        <id column="UUID" property="uuid"/>
        <result column="user_name" property="userName"/>
        <result column="user_pwd" property="userPwd"/>
        <result column="nick_name" property="nickName"/>
        <result column="user_sex" property="userSex"/>
        <result column="birthday" property="birthday"/>
        <result column="email" property="email"/>
        <result column="user_phone" property="userPhone"/>
        <result column="address" property="address"/>
        <result column="head_url" property="headUrl"/>
        <result column="biography" property="biography"/>
        <result column="life_state" property="lifeState"/>
        <result column="begin_time" property="beginTime"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>
    <resultMap id="UserInfoForGateway" type="com.stylefeng.guns.rest.user.model.MtimeUserInfo">
        <id column="UUID" property="uuid"/>
        <result column="user_name" property="username"/>
        <result column="nick_name" property="nickname"/>
        <result column="user_sex" property="sex"/>
        <result column="birthday" property="birthday"/>
        <result column="email" property="email"/>
        <result column="user_phone" property="phone"/>
        <result column="address" property="address"/>
        <result column="head_url" property="headAdress"/>
        <result column="biography" property="biography"/>
        <result column="life_state" property="lifeState"/>
        <result column="begin_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>
    <update id="updateUserInfo">
        update mtime_user_t
        set user_name=#{user.username},
            nick_name=#{user.nickname},
            user_sex=#{user.sex},
            birthday=#{user.birthday},
            email=#{user.email},
            user_phone=#{user.phone},
            address=#{user.address},
            head_url=#{user.headAdress},
            biography=#{user.biography},
            life_state=#{user.lifeState}
        where uuid = #{user.UUID}
    </update>
    <select id="selectUserByUserNameAndPassword" resultType="java.lang.Integer">
        select count(*)
        from mtime_user_t
        where user_name = #{userName}
          and user_pwd = #{password}
    </select>
    <sql id="BaseColumnExceptPassword">
        UUID,user_name,nick_name,user_sex,birthday,email,user_phone,address,head_url,biography,life_state,begin_time,update_time
    </sql>
    <sql id="BaseColumn">
        UUID,user_name,user_pwd,nick_name,user_sex,birthday,email,user_phone,address,head_url,biography,life_state,begin_time,update_time
    </sql>
    <select id="selectUserInfoForGatewayByUsername" resultMap="UserInfoForGateway">
        select
        <include refid="BaseColumnExceptPassword"/>
        from mtime_user_t
        where user_name = #{userName}
    </select>

    <select id="selectByUserName" resultType="java.lang.Integer">
        select count(*)
        from mtime_user_t
        where user_name = #{username}
    </select>
    <select id="selectUserByUserName" resultMap="BaseResultMap">
        select
        <include refid="BaseColumn"/>
        from mtime_user_t
        where user_name = #{userName}
    </select>
    <select id="selectUserById" resultType="com.stylefeng.guns.rest.common.persistence.model.MtimeUserT">
        select
        <include refid="BaseColumn"/>
        from mtime_user_t
        where UUID = #{uuid}
    </select>

</mapper>
